# -*- coding: utf-8 -*-
"""meta_builder

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1gbe-kvoKq-HK-VNpWuVLEhAczmHEF7jC
"""

import os
import pandas as pd

def build_meta_csv(dataset_dir, output_csv="meta.csv"):
    """
    Scan dataset folder and build meta.csv
    Format:
    file | label | path
    """
    records = []

    for label in os.listdir(dataset_dir):
        label_dir = os.path.join(dataset_dir, label)

        if not os.path.isdir(label_dir):
            continue

        for fname in os.listdir(label_dir):
            if fname.endswith(".npy"):
                records.append({
                    "file": fname,
                    "label": label,
                    "path": os.path.join(label_dir, fname)
                })

    df = pd.DataFrame(records)
    out_path = os.path.join(dataset_dir, output_csv)
    df.to_csv(out_path, index=False)

    print(f"âœ” meta.csv saved at: {out_path}")
    print(df['label'].value_counts())

    return df

